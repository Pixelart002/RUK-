<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>One-File Notification Demo</title>
</head>
<body>
  <h1>One-File Client Notification</h1>
  <button id="notifyBtn">Show Notification</button>

  <script>
    // Create inline Service Worker code as Blob
    const swCode = `
      self.addEventListener("install", () => {
        console.log("SW installed");
      });
    `;
    const swBlob = new Blob([swCode], { type: "application/javascript" });
    const swURL = URL.createObjectURL(swBlob);

    // Register Service Worker
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register(swURL).then(() => {
        console.log("SW registered inline");
      }).catch(err => console.error("SW failed:", err));
    }

    // Handle button click â†’ show notification
    document.getElementById("notifyBtn").addEventListener("click", async () => {
      const permission = await Notification.requestPermission();
      if (permission === "granted") {
        navigator.serviceWorker.ready.then(reg => {
          reg.showNotification("Hello ðŸ‘‹", {
            body: "This came from a single HTML file!",
            icon: "https://via.placeholder.com/128" // optional icon
          });
        });
      } else {
        alert("Notifications are blocked!");
      }
    });
  </script>
</body>
</html>